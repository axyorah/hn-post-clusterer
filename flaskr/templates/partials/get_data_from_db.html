<div class="box">

    <h3 class="mb-2">Select and Cluster</h3>

    <section id="db-filters">
        <p>
            You might want to narrow down the type and amount of posts that will be used for analysys.
        </p>
        <p>
            Start by selecting the range of post <code>id</code>s.

            To cluster posts we'll use post <code class="mark">comments</code> rather than post body.
            Because of that only posts with 5 or more comments will be "visible" for the analysis.
            You can narrow down the set of posts to be clustered even further
            by specifying the <code>number of comments</code> and <code>score</code> parameters.
        </p>

        {% include "partials/set_db_filters.html"%}

    </section>

    <section id="cluster-filters">
        
            
        <details>
            <summary class="mb-3">
                These posts will be preprocessed and clustered into 
                some reasonable <code>number of clusters</code> that you choose.
            </summary>
            <p>
                Specifically, we'll:
                <ul>
                    <li>
                        collect all relevant <code class="mark">comments</code>,
                    </li>
                    <li>
                        convert these comments to <code class="mark">number arrays</code> that Machine Learning algorithms can
                        work with.
                        <p class="li-comment">
                            These number array are called <code class="mark" b>embeddings</code>,
                            and we'll obtain them by passing each comment sentence-by-sentence to
                            <a href="https://huggingface.co/sentence-transformers/all-distilroberta-v1">DistilRoBERTa</a>
                            transformer
                            and averaging the results for each post.
                            The transformer that we'll use was pretrained on such datasets as
                            <a href="https://github.com/PolyAI-LDN/conversational-datasets/tree/master/reddit">Reddit
                                Comments</a>,
                            <a href="https://github.com/afader/oqa#wikianswers-corpus">WikiAnswers</a> and
                            <a href="https://www.kaggle.com/soumikrakshit/yahoo-answers-dataset">Yahoo Answers</a>,
                            so we can expect that it should perform reasonably well on our data, too.
                        </p>
                    </li>
                    <li>
                        <code class="mark">reduce the dimensionality</code> of embedding.
                        <p class="li-comment">
                            This is needed because clustering algorithm that we'll use doesn't work too well in
                            high-dimensional setting.
                            Each embedding generated by DistilRoBERTa is a 768-dimensional vector,
                            and this is definitely not optimal for clustering.
                            So we'll use a simple linear technique 
                            <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> 
                            to find 100 orthogonal vectors in 768-dimensional space along which our data varies the most 
                            and project our original data onto this 100-dimensional space.
                        </p>
                    </li>
                    <li>
                        cluster these reduced post embeddings with a help of 
                        <code class="mark"><a href="https://en.wikipedia.org/wiki/K-means_clustering">k-Means</a></code> clustering.
                        <p class="li-comment">
                            This method requires you to choose the <code>number of clusters</code>
                            that you want your data to be split into. You can set this parameter below.
                        </p>
                    </li>
                </ul>
            </p>

        </details>
        

        {% include "partials/set_clustering_filters.html" %}

    </section>

    <button id="semantic-cluster-btn">Cluster Posts</button>

</div>